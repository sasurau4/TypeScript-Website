{"componentChunkName":"component---src-templates-handbook-tsx","path":"/docs/handbook/release-notes/typescript-3-6.html","webpackCompilationHash":"9ba7cceb403e6d704a1e","result":{"data":{"markdownRemark":{"id":"ec38821d-0db9-57ab-aa53-c7b37f67f241","excerpt":"{% raw %}## Stricter Generators TypeScript 3.6 introduces stricter checking for iterators and generator functions.\nIn earlier versions, users of generators had…","html":"<p>{% raw %}## Stricter Generators</p>\n<p>TypeScript 3.6 introduces stricter checking for iterators and generator functions.\nIn earlier versions, users of generators had no way to differentiate whether a value was yielded or returned from a generator.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">function</span><span class=\"token operator\">*</span> <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">yield</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">\"Finished!\"</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">let</span> iter <span class=\"token operator\">=</span> <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> curr <span class=\"token operator\">=</span> iter<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>curr<span class=\"token punctuation\">.</span>done<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// TypeScript 3.5 and prior thought this was a 'string | number'.</span>\n    <span class=\"token comment\">// It should know it's 'string' since 'done' was 'true'!</span>\n    curr<span class=\"token punctuation\">.</span>value\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Additionally, generators just assumed the type of <code class=\"language-text\">yield</code> was always <code class=\"language-text\">any</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">function</span><span class=\"token operator\">*</span> <span class=\"token function\">bar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> x<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token function\">hello</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">yield</span><span class=\"token punctuation\">;</span>\n    x<span class=\"token punctuation\">.</span><span class=\"token function\">hello</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">let</span> iter <span class=\"token operator\">=</span> <span class=\"token function\">bar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\niter<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\niter<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token number\">123</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// oops! runtime error!</span></code></pre></div>\n<p>In TypeScript 3.6, the checker now knows that the correct type for <code class=\"language-text\">curr.value</code> should be <code class=\"language-text\">string</code> in our first example, and will correctly error on our call to <code class=\"language-text\">next()</code> in our last example.\nThis is thanks to some changes in the <code class=\"language-text\">Iterator</code> and <code class=\"language-text\">IteratorResult</code> type declarations to include a few new type parameters, and to a new type that TypeScript uses to represent generators called the <code class=\"language-text\">Generator</code> type.</p>\n<p>The <code class=\"language-text\">Iterator</code> type now allows users to specify the yielded type, the returned type, and the type that <code class=\"language-text\">next</code> can accept.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\">Iterator</span><span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> TReturn <span class=\"token operator\">=</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">,</span> TNext <span class=\"token operator\">=</span> undefined<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Takes either 0 or 1 arguments - doesn't accept 'undefined'</span>\n    <span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">|</span> <span class=\"token punctuation\">[</span>TNext<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> IteratorResult<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> TReturn<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span><span class=\"token operator\">?</span><span class=\"token punctuation\">(</span>value<span class=\"token operator\">?</span><span class=\"token punctuation\">:</span> TReturn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> IteratorResult<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> TReturn<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">throw</span><span class=\"token operator\">?</span><span class=\"token punctuation\">(</span>e<span class=\"token operator\">?</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> IteratorResult<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> TReturn<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Building on that work, the new <code class=\"language-text\">Generator</code> type is an <code class=\"language-text\">Iterator</code> that always has both the <code class=\"language-text\">return</code> and <code class=\"language-text\">throw</code> methods present, and is also iterable.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\">Generator</span><span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">unknown</span><span class=\"token punctuation\">,</span> TReturn <span class=\"token operator\">=</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">,</span> TNext <span class=\"token operator\">=</span> <span class=\"token builtin\">unknown</span><span class=\"token operator\">></span>\n        <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Iterator</span><span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> TReturn<span class=\"token punctuation\">,</span> TNext<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">|</span> <span class=\"token punctuation\">[</span>TNext<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> IteratorResult<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> TReturn<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">:</span> TReturn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> IteratorResult<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> TReturn<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">throw</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> IteratorResult<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> TReturn<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">[</span>Symbol<span class=\"token punctuation\">.</span>iterator<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> Generator<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> TReturn<span class=\"token punctuation\">,</span> TNext<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>To allow differentiation between returned values and yielded values, TypeScript 3.6 converts the <code class=\"language-text\">IteratorResult</code> type to a discriminated union type:</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">type</span> IteratorResult<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> TReturn <span class=\"token operator\">=</span> <span class=\"token builtin\">any</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> IteratorYieldResult<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span> <span class=\"token operator\">|</span> IteratorReturnResult<span class=\"token operator\">&lt;</span>TReturn<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">IteratorYieldResult</span><span class=\"token operator\">&lt;</span>TYield<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    done<span class=\"token operator\">?</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n    value<span class=\"token punctuation\">:</span> TYield<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">IteratorReturnResult</span><span class=\"token operator\">&lt;</span>TReturn<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    done<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    value<span class=\"token punctuation\">:</span> TReturn<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>In short, what this means is that you’ll be able to appropriately narrow down values from iterators when dealing with them directly.</p>\n<p>To correctly represent the types that can be passed in to a generator from calls to <code class=\"language-text\">next()</code>, TypeScript 3.6 also infers certain uses of <code class=\"language-text\">yield</code> within the body of a generator function.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">function</span><span class=\"token operator\">*</span> <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> x<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">yield</span><span class=\"token punctuation\">;</span>\n    <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">.</span><span class=\"token function\">toUpperCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">let</span> x <span class=\"token operator\">=</span> <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nx<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// first call to 'next' is always ignored</span>\nx<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token number\">42</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// error! 'number' is not assignable to 'string'</span></code></pre></div>\n<p>If you’d prefer to be explicit, you can also enforce the type of values that can be returned, yielded, and evaluated from <code class=\"language-text\">yield</code> expressions using an explicit return type.\nBelow, <code class=\"language-text\">next()</code> can only be called with <code class=\"language-text\">boolean</code>s, and depending on the value of <code class=\"language-text\">done</code>, <code class=\"language-text\">value</code> is either a <code class=\"language-text\">string</code> or a <code class=\"language-text\">number</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token comment\">/**\n * - yields numbers\n * - returns strings\n * - can be passed in booleans\n */</span>\n<span class=\"token keyword\">function</span><span class=\"token operator\">*</span> <span class=\"token function\">counter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> Generator<span class=\"token operator\">&lt;</span><span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">boolean</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">yield</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">\"done!\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> iter <span class=\"token operator\">=</span> <span class=\"token function\">counter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> curr <span class=\"token operator\">=</span> iter<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>curr<span class=\"token punctuation\">.</span>done<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>curr<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    curr <span class=\"token operator\">=</span> iter<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span>curr<span class=\"token punctuation\">.</span>value <span class=\"token operator\">===</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>curr<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">.</span><span class=\"token function\">toUpperCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// prints:</span>\n<span class=\"token comment\">//</span>\n<span class=\"token comment\">// 0</span>\n<span class=\"token comment\">// 1</span>\n<span class=\"token comment\">// 2</span>\n<span class=\"token comment\">// 3</span>\n<span class=\"token comment\">// 4</span>\n<span class=\"token comment\">// 5</span>\n<span class=\"token comment\">// DONE!</span></code></pre></div>\n<p>For more details on the change, <a href=\"https://github.com/Microsoft/TypeScript/issues/2983\">see the pull request here</a>.</p>\n<h2>More Accurate Array Spread</h2>\n<p>In pre-ES2015 targets, the most faithful emit for constructs like <code class=\"language-text\">for</code>/<code class=\"language-text\">of</code> loops and array spreads can be a bit heavy.\nFor this reason, TypeScript uses a simpler emit by default that only supports array types, and supports iterating on other types using the <code class=\"language-text\">--downlevelIteration</code> flag.\nThe looser default without <code class=\"language-text\">--downlevelIteration</code> works fairly well; however, there were some common cases where the transformation of array spreads had observable differences.\nFor example, the following array containing a spread</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token punctuation\">[</span><span class=\"token operator\">...</span><span class=\"token function\">Array</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>can be rewritten as the following array literal</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">[</span><span class=\"token keyword\">undefined</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>However, TypeScript would instead transform the original code into this code:</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token function\">Array</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>which is slightly different.\n<code class=\"language-text\">Array(5)</code> produces an array with a length of 5, but with no defined property slots.</p>\n<p>TypeScript 3.6 introduces a new <code class=\"language-text\">__spreadArrays</code> helper to accurately model what happens in ECMAScript 2015 in older targets outside of <code class=\"language-text\">--downlevelIteration</code>.\n<code class=\"language-text\">__spreadArrays</code> is also available in <a href=\"https://github.com/Microsoft/tslib/\">tslib</a>.</p>\n<p>For more information, <a href=\"https://github.com/microsoft/TypeScript/pull/31166\">see the relevant pull request</a>.</p>\n<h2>Improved UX Around Promises</h2>\n<p>TypeScript 3.6 introduces some improvements for when <code class=\"language-text\">Promise</code>s are mis-handled.</p>\n<p>For example, it’s often very common to forget to <code class=\"language-text\">.then()</code> or <code class=\"language-text\">await</code> the contents of a <code class=\"language-text\">Promise</code> before passing it to another function.\nTypeScript’s error messages are now specialized, and inform the user that perhaps they should consider using the <code class=\"language-text\">await</code> keyword.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\">User</span> <span class=\"token punctuation\">{</span>\n    name<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n    age<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n    location<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">declare</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getUserData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">Promise</span><span class=\"token operator\">&lt;</span>User<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">declare</span> <span class=\"token keyword\">function</span> <span class=\"token function\">displayUser</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">user<span class=\"token punctuation\">:</span> User</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">f</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">displayUser</span><span class=\"token punctuation\">(</span><span class=\"token function\">getUserData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//              ~~~~~~~~~~~~~</span>\n<span class=\"token comment\">// Argument of type 'Promise&lt;User>' is not assignable to parameter of type 'User'.</span>\n<span class=\"token comment\">//   ...</span>\n<span class=\"token comment\">// Did you forget to use 'await'?</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>It’s also common to try to access a method before <code class=\"language-text\">await</code>-ing or <code class=\"language-text\">.then()</code>-ing a <code class=\"language-text\">Promise</code>.\nThis is another example, among many others, where we’re able to do better.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getCuteAnimals</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"https://reddit.com/r/aww.json\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">//   ~~~~</span>\n    <span class=\"token comment\">// Property 'json' does not exist on type 'Promise&lt;Response>'.</span>\n    <span class=\"token comment\">//</span>\n    <span class=\"token comment\">// Did you forget to use 'await'?</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>For more details, <a href=\"https://github.com/microsoft/TypeScript/issues/30646\">see the originating issue</a>, as well as the pull requests that link back to it.</p>\n<h2>Better Unicode Support for Identifiers</h2>\n<p>TypeScript 3.6 contains better support for Unicode characters in identifiers when emitting to ES2015 and later targets.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">const</span> 𝓱𝓮𝓵𝓵𝓸 <span class=\"token operator\">=</span> <span class=\"token string\">\"world\"</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// previously disallowed, now allowed in '--target es2015'</span></code></pre></div>\n<h2><code class=\"language-text\">import.meta</code> Support in SystemJS</h2>\n<p>TypeScript 3.6 supports transforming <code class=\"language-text\">import.meta</code> to <code class=\"language-text\">context.meta</code> when your <code class=\"language-text\">module</code> target is set to <code class=\"language-text\">system</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token comment\">// This module:</span>\n\n<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">import</span><span class=\"token punctuation\">.</span>meta<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// gets turned into the following:</span>\n\nSystem<span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">exports<span class=\"token punctuation\">,</span> context</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    setters<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function-variable function\">execute</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">.</span>meta<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2><code class=\"language-text\">get</code> and <code class=\"language-text\">set</code> Accessors Are Allowed in Ambient Contexts</h2>\n<p>In previous versions of TypeScript, the language didn’t allow <code class=\"language-text\">get</code> and <code class=\"language-text\">set</code> accessors in ambient contexts (like in <code class=\"language-text\">declare</code>-d classes, or in <code class=\"language-text\">.d.ts</code> files in general).\nThe rationale was that accessors weren’t distinct from properties as far as writing and reading to these properties;\nhowever, <a href=\"https://github.com/tc39/proposal-class-fields/issues/248\">because ECMAScript’s class fields proposal may have differing behavior from in existing versions of TypeScript</a>, we realized we needed a way to communicate this different behavior to provide appropriate errors in subclasses.</p>\n<p>As a result, users can write getters and setters in ambient contexts in TypeScript 3.6.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">declare</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Foo</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Allowed in 3.6+.</span>\n    <span class=\"token keyword\">get</span> <span class=\"token function\">x</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">set</span> <span class=\"token function\">x</span><span class=\"token punctuation\">(</span>val<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>In TypeScript 3.7, the compiler itself will take advantage of this feature so that generated <code class=\"language-text\">.d.ts</code> files will also emit <code class=\"language-text\">get</code>/<code class=\"language-text\">set</code> accessors.</p>\n<h2>Ambient Classes and Functions Can Merge</h2>\n<p>In previous versions of TypeScript, it was an error to merge classes and functions under any circumstances.\nNow, ambient classes and functions (classes/functions with the <code class=\"language-text\">declare</code> modifier, or in <code class=\"language-text\">.d.ts</code> files) can merge.\nThis means that now you can write the following:</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">declare</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Point2D</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">x<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> Point2D<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">declare</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Point2D</span> <span class=\"token punctuation\">{</span>\n    x<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n    y<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">constructor</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>instead of needing to use </p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Point2D</span> <span class=\"token punctuation\">{</span>\n    x<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n    y<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">declare</span> <span class=\"token keyword\">var</span> Point2D<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> Point2D<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">new</span> <span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> Point2D<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>One advantage of this is that the callable constructor pattern can be easily expressed while also allowing namespaces to merge with these declarations (since <code class=\"language-text\">var</code> declarations can’t merge with <code class=\"language-text\">namespace</code>s).</p>\n<p>In TypeScript 3.7, the compiler will take advantage of this feature so that <code class=\"language-text\">.d.ts</code> files generated from <code class=\"language-text\">.js</code> files can appropriately capture both the callability and constructability of a class-like function.</p>\n<p>For more details, <a href=\"https://github.com/microsoft/TypeScript/pull/32584\">see the original PR on GitHub</a>.</p>\n<h2>APIs to Support <code class=\"language-text\">--build</code> and <code class=\"language-text\">--incremental</code></h2>\n<p>TypeScript 3.0 introduced support for referencing other and building them incrementally using the <code class=\"language-text\">--build</code> flag.\nAdditionally, TypeScript 3.4 introduced the <code class=\"language-text\">--incremental</code> flag for saving information about previous compilations to only rebuild certain files.\nThese flags were incredibly useful for structuring projects more flexibly and speeding builds up.\nUnfortunately, using these flags didn’t work with 3rd party build tools like Gulp and Webpack.\nTypeScript 3.6 now exposes two sets of APIs to operate on project references and incremental program building.</p>\n<p>For creating <code class=\"language-text\">--incremental</code> builds, users can leverage the <code class=\"language-text\">createIncrementalProgram</code> and <code class=\"language-text\">createIncrementalCompilerHost</code> APIs.\nUsers can also re-hydrate old program instances from <code class=\"language-text\">.tsbuildinfo</code> files generated by this API using the newly exposed <code class=\"language-text\">readBuilderProgram</code> function, which is only meant to be used as for creating new programs (i.e. you can’t modify the returned instance - it’s only meant to be used for the <code class=\"language-text\">oldProgram</code> parameter in other <code class=\"language-text\">create*Program</code> functions).</p>\n<p>For leveraging project references, a new <code class=\"language-text\">createSolutionBuilder</code> function has been exposed, which returns an instance of the new type <code class=\"language-text\">SolutionBuilder</code>.</p>\n<p>For more details on these APIs, you can <a href=\"https://github.com/microsoft/TypeScript/pull/31432\">see the original pull request</a>.</p>\n<h2>Semicolon-Aware Code Edits</h2>\n<p>Editors like Visual Studio and Visual Studio Code can automatically apply quick fixes, refactorings, and other transformations like automatically importing values from other modules.\nThese transformations are powered by TypeScript, and older versions of TypeScript unconditionally added semicolons to the end of every statement; unfortunately, this disagreed with many users’ style guidelines, and many users were displeased with the editor inserting semicolons.</p>\n<p>TypeScript is now smart enough to detect whether your file uses semicolons when applying these sorts of edits.\nIf your file generally lacks semicolons, TypeScript won’t add one.</p>\n<p>For more details, <a href=\"https://github.com/microsoft/TypeScript/pull/31801\">see the corresponding pull request</a>.</p>\n<h2>Smarter Auto-Import Syntax</h2>\n<p>JavaScript has a lot of different module syntaxes or conventions: the one in the ECMAScript standard, the one Node already supports (CommonJS), AMD, System.js, and more!\nFor the most part, TypeScript would default to auto-importing using ECMAScript module syntax, which was often inappropriate in certain TypeScript projects with different compiler settings, or in Node projects with plain JavaScript and <code class=\"language-text\">require</code> calls.</p>\n<p>TypeScript 3.6 is now a bit smarter about looking at your existing imports before deciding on how to auto-import other modules.\nYou can <a href=\"https://github.com/microsoft/TypeScript/pull/32684\">see more details in the original pull request here</a>.</p>\n<h2><code class=\"language-text\">await</code> Completions on Promises</h2>\n<p>In TypeScript 3.6, completions on an </p>\n<h2>New TypeScript Playground</h2>\n<p>The TypeScript playground has received a much-needed refresh with handy new functionality!\nThe new playground is largely a fork of <a href=\"https://github.com/agentcooper\">Artem Tyurin</a>’s <a href=\"https://github.com/agentcooper/typescript-play\">TypeScript playground</a> which community members have been using more and more.\nWe owe Artem a big thanks for helping out here!</p>\n<p>The new playground now supports many new options including:</p>\n<ul>\n<li>The <code class=\"language-text\">target</code> option (allowing users to switch out of <code class=\"language-text\">es5</code> to <code class=\"language-text\">es3</code>, <code class=\"language-text\">es2015</code>, <code class=\"language-text\">esnext</code>, etc.)</li>\n<li>All the strictness flags (including just <code class=\"language-text\">strict</code>)</li>\n<li>Support for plain JavaScript files (using <code class=\"language-text\">allowJS</code> and optionally <code class=\"language-text\">checkJs</code>)</li>\n</ul>\n<p>These options also persist when sharing links to playground samples, allowing users to more reliably share examples without having to tell the recipient “oh, don’t forget to turn on the <code class=\"language-text\">noImplicitAny</code> option!“.</p>\n<p>In the near future, we’re going to be refreshing the playground samples, adding JSX support, and polishing automatic type acquisition, meaning that you’ll be able to see the same experience on the playground as you’d get in your personal editor.</p>\n<p>As we improve the playground and the website, <a href=\"https://github.com/microsoft/TypeScript-Website/\">we welcome feedback and pull requests on GitHub</a>!</p>\n<p>{% endraw %}</p>","frontmatter":{"permalink":"/docs/handbook/release-notes/typescript-3-6.html"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/docs/handbook/release-notes/typescript-3-6.html","isOldHandbook":true}}}